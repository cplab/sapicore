

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>engine.neuron &mdash; Sapicore  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
      <script src="../../_static/jquery.js"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
      <script src="../../_static/doctools.js"></script>
      <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="engine.neuron.analog" href="engine.neuron.analog.html" />
    <link rel="prev" title="engine.network" href="engine.network.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Sapicore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api.html">Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html#engine">Engine</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="engine.html">engine</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="engine.component.html">engine.component</a></li>
<li class="toctree-l3"><a class="reference internal" href="engine.ensemble.html">engine.ensemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="engine.network.html">engine.network</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">engine.neuron</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#engine.neuron.Neuron"><code class="docutils literal notranslate"><span class="pre">Neuron</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="engine.neuron.analog.html">engine.neuron.analog</a></li>
<li class="toctree-l4"><a class="reference internal" href="engine.neuron.spiking.html">engine.neuron.spiking</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="engine.synapse.html">engine.synapse</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#workflow">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#utilities">Utilities</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Sapicore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">Data</a></li>
          <li class="breadcrumb-item"><a href="engine.html">engine</a></li>
      <li class="breadcrumb-item active">engine.neuron</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/_autosummary/engine.neuron.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-engine.neuron">
<span id="engine-neuron"></span><h1>engine.neuron<a class="headerlink" href="#module-engine.neuron" title="Permalink to this heading"></a></h1>
<p>Neurons are units that receive, integrate, and emit signals.</p>
<p>Neuron instance attributes are 1D tensors of arbitrary length, initialized with a single element by default.</p>
<p>Neurons maintain a numeric state akin to a membrane potential in the float32 tensor <cite>voltage</cite>,
and sometimes a binary integer tensor <cite>spiked</cite> representing emitted action potential events.</p>
<p>All classes derived from <a class="reference internal" href="#engine.neuron.Neuron" title="engine.neuron.Neuron"><code class="xref py py-class docutils literal notranslate"><span class="pre">Neuron</span></code></a> must implement the parent
<a class="reference internal" href="engine.component.html#engine.component.Component.forward" title="engine.component.Component.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a> method.</p>
<dl class="py class">
<dt class="sig sig-object py" id="engine.neuron.Neuron">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">engine.neuron.</span></span><span class="sig-name descname"><span class="pre">Neuron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Integrator</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#engine.neuron.Neuron" title="Permalink to this definition"></a></dt>
<dd><p>Generic neuron base class.</p>
<p>Defines and initializes instance attributes shared by all neuron objects, over and above the universal
specifications handled by the parent class <a class="reference internal" href="engine.component.html#engine.component.Component" title="engine.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<em>Callable</em><em> or </em><em>tuple</em><em>, </em><em>optional</em>) – <p>Anonymous function(s) specifying this neuron’s difference equation(s). Provided here since all neurons
may utilize an explicit declaration of their update rule for numeric approximation purposes.</p>
<p>This is strictly optional but necessary for utilizing Sapicore’s integrators. If provided, the lambda syntax
should be used (lambda x, data: f(x, data)).</p>
<p>If the Euler update rule is v[t+1] = v[t] + f(v[t])*DT, <cite>self.equation</cite> should be the f(v[t]) portion.
This is because RK4 needs to compute f(v[t]) at different points, e.g. half a time step forward.</p>
</p></li>
<li><p><strong>integrator</strong> (<a class="reference internal" href="utils.integration.html#utils.integration.Integrator" title="utils.integration.Integrator"><em>Integrator</em></a><em>, </em><em>optional</em>) – Specifies an <a class="reference internal" href="utils.integration.html#utils.integration.Integrator" title="utils.integration.Integrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integrator</span></code></a> to be used when approximating the next value(s)
of this neuron’s dynamic variable(s), e.g. voltage. Requires explicitly defining <cite>equation</cite>.
Defaults to Runge-Kutta of order 4 to increase accuracy at a small performance penalty.</p></li>
<li><p><strong>input</strong> (<em>Tensor</em>) – PyTorch registered buffer tracking the input current(s) received in this simulation step.</p></li>
<li><p><strong>voltage</strong> (<em>Tensor</em>) – PyTorch registered buffer tracking the numeric state of the unit represented by this neuron instance,
corresponding to a membrane voltage.</p></li>
<li><p><strong>kwargs</strong> – Additional instance attributes that the user may set.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When defining <cite>equation</cite> for a custom neuron model, the present value of <cite>voltage</cite> should NOT be added to the
right hand side. Do NOT multiply by DT. These operations will be performed within the Integrator.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="engine.neuron.Neuron.aggregate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">torch.Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#engine.neuron.Neuron.aggregate" title="Permalink to this definition"></a></dt>
<dd><p>Determines how presynaptic inputs from multiple sources should be aggregated.</p>
<p>By default, neurons sum their inputs. However, many use cases may require more sophistication.
Shunting inhibition, for instance, can be expressed with torch.div (or torch.prod, if the source
synapse is expected to send the inverse).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list</em><em> of </em><em>Tensor</em>) – Input arriving at this layer, synaptic or external.</p></li>
<li><p><strong>identifiers</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Labels by which to micromanage input aggregation. Since some inputs may not be
synaptic, users are responsible for passing identifiers in an order matching that of the input tensors.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your model requires identifier-dependent preprocessing of synaptic inputs to this neuron (e.g., a
combination of addition and multiplication), it can be implemented by overriding this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="engine.neuron.Neuron.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#engine.neuron.Neuron.forward" title="Permalink to this definition"></a></dt>
<dd><p>Passes input through the neuron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Tensor</em>) – Input current whose value is used to compute the next value of the numeric state tensor <cite>voltage</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary whose keys are loggable attributes and whose values are their states as of this time step.
For potential use by a <code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleSimulator</span></code> or any other
<a class="reference internal" href="pipeline.html#pipeline.Pipeline" title="pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a> script handling runtime operations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – The forward method must be implemented by derivative classes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="engine.neuron.Neuron.gate_signal">
<span class="sig-name descname"><span class="pre">gate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#engine.neuron.Neuron.gate_signal" title="Permalink to this definition"></a></dt>
<dd><p>Inject external gating <cite>signal</cite>, to be multiplied by synaptic input to this neuron.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Has no effect unless derivative class forward method utilizes it.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="engine.neuron.Neuron.inject">
<span class="sig-name descname"><span class="pre">inject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#engine.neuron.Neuron.inject" title="Permalink to this definition"></a></dt>
<dd><p>Injects a current into this neuron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current</strong> (<em>Tensor</em>) – Float tensor containing value(s) to be added to this neuron’s <cite>voltage</cite> tensor.</p></li>
<li><p><strong>mult</strong> (<em>bool</em>) – Whether the current is multiplicative. Defaults to additive (False).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="engine.neuron.Neuron.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#engine.neuron.Neuron.integrate" title="Permalink to this definition"></a></dt>
<dd><p>Generic support for numeric approximation.</p>
<p>This wrapper is meant to be called from within <a class="reference internal" href="#engine.neuron.Neuron.forward" title="engine.neuron.Neuron.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a> in the voltage
update step. Its purpose is to take the difference equation defining a neuron and approximate the
voltage value at time t + <a class="reference internal" href="utils.constants.html#utils.constants.DT" title="utils.constants.DT"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DT</span></code></a>. Keyword arguments should include variables that
<cite>equation</cite> depends on. The argument <cite>x</cite> is the tensor’s state at time t, typically <cite>voltage</cite>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="utils.integration.html#utils.integration.RungeKutta" title="utils.integration.RungeKutta"><code class="xref py py-class docutils literal notranslate"><span class="pre">RungeKutta</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="engine.neuron.Neuron.num_units">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_units</span></span><a class="headerlink" href="#engine.neuron.Neuron.num_units" title="Permalink to this definition"></a></dt>
<dd><p>Number of functional units represented by this object.</p>
<p>Neurons are singletons by coercion, as they are meant to express and encapsulate unit dynamics.
Derivatives of <a class="reference internal" href="engine.ensemble.html#engine.ensemble.Ensemble" title="engine.ensemble.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code></a> can modify this property and duplicate units as necessary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="engine.neuron.Neuron.teach_signal">
<span class="sig-name descname"><span class="pre">teach_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#engine.neuron.Neuron.teach_signal" title="Permalink to this definition"></a></dt>
<dd><p>Inject external teaching <cite>signal</cite>, to replace synaptic input to this neuron.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Has no effect unless derivative class forward method utilizes it.</p>
</div>
</dd></dl>

</dd></dl>

<p class="rubric">Modules</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="engine.neuron.analog.html#module-engine.neuron.analog" title="engine.neuron.analog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">engine.neuron.analog</span></code></a></p></td>
<td><p>Analog neurons emit real numbers, usually onto static synapses.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="engine.neuron.spiking.html#module-engine.neuron.spiking" title="engine.neuron.spiking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">engine.neuron.spiking</span></code></a></p></td>
<td><p>Spiking neurons emit all-or-none events once their numeric state surpasses a critical threshold.</p></td>
</tr>
</tbody>
</table>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="engine.network.html" class="btn btn-neutral float-left" title="engine.network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="engine.neuron.analog.html" class="btn btn-neutral float-right" title="engine.neuron.analog" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Roy Moyal, Matthew Einhorn, Jeremy Forest, Ayon Borthakur, Chen Yang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>