

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>utils.sweep &mdash; Sapicore  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
      <script src="../../_static/jquery.js"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
      <script src="../../_static/doctools.js"></script>
      <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="utils.tensorboard" href="utils.tensorboard.html" />
    <link rel="prev" title="utils.signals" href="utils.signals.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Sapicore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#engine">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#workflow">Workflow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html#utilities">Utilities</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="utils.html">utils</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="utils.constants.html">utils.constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.integration.html">utils.integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.io.html">utils.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.loggable.html">utils.loggable</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.plotting.html">utils.plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.seed.html">utils.seed</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.signals.html">utils.signals</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">utils.sweep</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#utils.sweep.Sweep"><code class="docutils literal notranslate"><span class="pre">Sweep</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils.tensorboard.html">utils.tensorboard</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Sapicore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">Data</a></li>
          <li class="breadcrumb-item"><a href="utils.html">utils</a></li>
      <li class="breadcrumb-item active">utils.sweep</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/api/_autosummary/utils.sweep.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-utils.sweep">
<span id="utils-sweep"></span><h1>utils.sweep<a class="headerlink" href="#module-utils.sweep" title="Permalink to this heading"></a></h1>
<p>Sweep hyperparameter or argument search spaces.</p>
<dl class="py class">
<dt class="sig sig-object py" id="utils.sweep.Sweep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.sweep.</span></span><span class="sig-name descname"><span class="pre">Sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_combinations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.sweep.Sweep" title="Permalink to this definition"></a></dt>
<dd><p>Reads a <cite>search_space</cite> dictionary and generates appropriate parameter combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>search_space</strong> (<em>dict</em>) – Dictionaries of argument keys and their possible values (or scipy distributions and parameters),
grouped by top-level keys specifying the sweep strategy to be used with each.
Search spaces are typically stored in the <cite>sweep</cite> key  of a <a class="reference internal" href="engine.component.html#engine.component.Component" title="engine.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>
configuration dictionary.</p>
</dd>
</dl>
<p>Search space parameters are expected to be found under one of four top-level keys:</p>
<p>1. <strong>Fixed</strong>: The argument takes the same value across all branches. E.g., if
settings[“fixed”][“resample”]=100, resample will always take the value 100.</p>
<p>2. <strong>Zipped</strong>: The values of the arguments listed are iterated over such that the Nth value of any argument is
matched with the Nth value of other arguments. Combinations are repeated as many times as it takes
to reach the number of combinations dictated by construction or by specification.
E.g., if settings[“zipped”][“freq_band”] = [[5, 10], [30, 50]] and … [“resample”] = [50, 100],
then <cite>self.combinations</cite> will have freq_band = [5, 10] with resample = 50 in half the branches,
and freq_band = [30, 50] with resample = 100 in the other half.</p>
<p>3. <strong>Grid</strong>: The values of the keys listed are iterated over such that any value combination is
equally represented in the resulting dictionary. Combinations are repeated as many times as it takes to reach
the number of combinations dictated by construction or by specification.
E.g., if settings[“zipped”][“freq_band”] = [[5, 10], [30, 50]] and …[“resample”] = [50, 100],
then <cite>self.combinations</cite> will have four qualitatively distinct groups, with (freq_band, resample) taking
one of the following combined values: ([5, 10], 50), ([5, 10], 100), ([30, 50], 50), ([30, 50], 100).</p>
<p>4. <strong>Random</strong>: The values of the parameter keys listed are drawn from a <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.15.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> distribution given
under the key “method”, with the arguments “args”. E.g., if settings[“random”][“resample”][“method”]=”uniform”
and …[“args”] = [x, y], then <cite>resample</cite> values will be drawn from <cite>U(x, x+y)</cite>.</p>
<p class="rubric">Example</p>
<p>Define a search space and generate a list of parameter combination dictionaries:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Sweep</span><span class="p">(</span><span class="n">search_space</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fixed&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]}},</span> <span class="n">num_combinations</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">())</span>
<span class="go">[{&#39;a&#39;: 4, &#39;b&#39;: 6, &#39;c&#39;: 8}, {&#39;a&#39;: 4, &#39;b&#39;: 6, &#39;c&#39;: 9}, {&#39;a&#39;: 4, &#39;b&#39;: 7, &#39;c&#39;: 8}, {&#39;a&#39;: 4, &#39;b&#39;: 7, &#39;c&#39;: 9}]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#continuous-distributions">Scipy Distributions</a></dt><dd><p>For a list of supported probability distributions and their arguments.</p>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="utils.sweep.Sweep.count_combinations">
<span class="sig-name descname"><span class="pre">count_combinations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#utils.sweep.Sweep.count_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Counts search space configurations and sets <cite>num_combinations</cite> if not provided or invalid.</p>
<p>Enforces the following contract w.r.t. the calculated number of combinations (NoC):</p>
<p>1. If NoC was not provided by the user, the calculated value is the minimal one ensuring that every unique
parameter combination can be represented.</p>
<p>2. If NoC was provided, the calculated value will be either equal to or greater than the requested number.
The calculated value will be greater iff the user’s value will result in an imbalance (i.e., if not
every parameter combination can be represented with that NoC). In such cases, the user should
intentionally sample from the larger combination dictionary in a way they see fit. Generally,
users should keep balancing considerations in mind when designing heterogeneous layers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.sweep.Sweep.extract_combinations">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extract_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#utils.sweep.Sweep.extract_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Extracts all parameter combinations from <cite>parameters</cite> based on the traversal <cite>mode</cite> given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – Dictionary, possibly loaded from YAML, containing parameters and their levels.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Combination strategy, “grid” if all parameter permutations should be tested or “zipped” for a linear pass.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#utils.sweep.Sweep" title="utils.sweep.Sweep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sweep</span></code></a></dt><dd><p>For a full documentation of parameter sweep strategies.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.sweep.Sweep.generate_combinations">
<span class="sig-name descname"><span class="pre">generate_combinations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#utils.sweep.Sweep.generate_combinations" title="Permalink to this definition"></a></dt>
<dd><p>Determine the argument combinations defining this sweep, update the <cite>combinations</cite> attribute,
and return its value for potential use by the calling function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.sweep.Sweep.heterogenize">
<span class="sig-name descname"><span class="pre">heterogenize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unravel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#utils.sweep.Sweep.heterogenize" title="Permalink to this definition"></a></dt>
<dd><p>Initializes attribute tensors heterogeneously based on a given sweep search dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference internal" href="engine.component.html#engine.component.Component" title="engine.component.Component"><em>Component</em></a>) – Sapicore engine component whose parameters will be diversified (currently, either
<a class="reference internal" href="engine.ensemble.html#engine.ensemble.Ensemble" title="engine.ensemble.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ensemble</span></code></a> or <a class="reference internal" href="engine.synapse.html#engine.synapse.Synapse" title="engine.synapse.Synapse"><code class="xref py py-class docutils literal notranslate"><span class="pre">Synapse</span></code></a>).</p></li>
<li><p><strong>unravel</strong> (<em>bool</em>) – When the property is a 2D tensor, dictates whether combination values should be assigned
to individual elements (True, default) or overwrite entire rows (False).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="utils.signals.html" class="btn btn-neutral float-left" title="utils.signals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="utils.tensorboard.html" class="btn btn-neutral float-right" title="utils.tensorboard" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Roy Moyal, Matthew Einhorn, Jeremy Forest, Ayon Borthakur, Chen Yang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>